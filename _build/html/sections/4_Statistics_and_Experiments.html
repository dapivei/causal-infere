
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4. Hypothesis testing and Introduction to Experiments &#8212; Causal Inference for Data Science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'sections/4_Statistics_and_Experiments';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. Experiments (Cont.)" href="5_Experiments.html" />
    <link rel="prev" title="3. Probability, All Causes Model and Statistics" href="3_Probability_Statistics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Causal Inference for Data Science - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Causal Inference for Data Science - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to Causal Inference
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1_Introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_Probability_1-2.html">2. Probability</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_Probability_Statistics.html">3. Probability, All Causes Model and Statistics</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">4. Hypothesis testing and Introduction to Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_Experiments.html">5. Experiments (Cont.)</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_Regression_1-2.html">6. Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_Natural_Experiments.html">7. Natural Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_ML_and_Causality.html">8. The Interplay between Machine Learning and Causal Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="9_Matching.html">9. Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_Instruments.html">10. Instrumental Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_Instruments_RDD.html">11. Instrumental Variables(Continued)</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_RDD.html">12. Instrumental Variables (Continued) and Intro to Regression Discontinuity (RDD)</a></li>

<li class="toctree-l1"><a class="reference internal" href="13_Difference_in_Differences.html">14. Difference in Differences</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_Review.html">15. Final Review</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fsections/4_Statistics_and_Experiments.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/sections/4_Statistics_and_Experiments.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Hypothesis testing and Introduction to Experiments</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-from-last-class">4.1. Recap from last class</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#goals-for-today">4.2. Goals for today</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-testing">4.3. Hypothesis Testing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-concepts">4.3.1. Key Concepts</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simulate-a-dataset">4.3.1.1. a) Simulate a Dataset</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-our-hypothesis">4.3.1.2. Define our hypothesis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-a-significance-level-alpha">4.3.1.3. Set a significance level $\alpha$</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#d-compute-t-n">4.3.1.4. d) Compute $T_n$</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-critical-value-c">4.3.1.5. Define the critical value $c$</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#p-n">4.3.1.6. $p_n$</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-sets">4.3.1.7. Confidence Sets</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistics-final-recap">4.4. Statistics (final recap)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#experiments">4.5. Experiments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#path-forward">4.6. Path Forward</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a class="reference external" href="https://colab.research.google.com/github/dapivei/causal-infere/blob/main/sections/4_Statistics_and_Experiments.ipynb"><img alt="Open in Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<section id="hypothesis-testing-and-introduction-to-experiments">
<h1><span class="section-number">4. </span>Hypothesis testing and Introduction to Experiments<a class="headerlink" href="#hypothesis-testing-and-introduction-to-experiments" title="Link to this heading">#</a></h1>
<section id="recap-from-last-class">
<h2><span class="section-number">4.1. </span>Recap from last class<a class="headerlink" href="#recap-from-last-class" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Conditional variance, weak law of large numbers, central limit theorem!</p></li>
</ul>
</section>
<section id="goals-for-today">
<h2><span class="section-number">4.2. </span>Goals for today<a class="headerlink" href="#goals-for-today" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Review hypothesis testing.</p></li>
<li><p>A final review of Statistics.</p></li>
<li><p>Experiments, an introduction.</p></li>
</ul>
</section>
<section id="hypothesis-testing">
<h2><span class="section-number">4.3. </span>Hypothesis Testing<a class="headerlink" href="#hypothesis-testing" title="Link to this heading">#</a></h2>
<p>A key goal in causal inference is to make informed decisions based on sample data. Hypothesis testing helps us decide whether to <strong>accept</strong> or <strong>reject</strong> a claim about a population parameter based on evidence from our data.</p>
<section id="key-concepts">
<h3><span class="section-number">4.3.1. </span>Key Concepts<a class="headerlink" href="#key-concepts" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Null Hypothesis ($H_0$)</strong>:<br />
Represents the default assumption we aim to <strong>disprove</strong>. For example, in a medical trial, it might state that a new treatment has no effect.</p></li>
<li><p><strong>Alternative Hypothesis ($H_1$)</strong>:<br />
What we want to <strong>prove</strong> through analysis, proposing an outcome different from $H_0$. For instance, it may claim that the new treatment <strong>does</strong> have an effect.</p></li>
<li><p><strong>Test Statistic ($T_n$)</strong>:<br />
A measure of how far our sample data deviates from expectations under $H_0$, quantifying the strength of evidence against it.</p></li>
<li><p><strong>Critical Value ($c$)</strong>:<br />
A threshold defining what is “significant” evidence. If our test statistic exceeds this value, we reject $H_0$.</p></li>
<li><p><strong>Decision Rule</strong>:<br />
If the test statistic is greater than the $c$, we reject $H_0$ in favor of $H_1$. If it’s less than or equal to the critical value, we <strong>fail to reject</strong> $H_0$. Note that failing to reject $H_0$ does not prove it true; it just indicates insufficient evidence against it.</p></li>
</ol>
<blockquote>
<div><p><strong>Significance</strong> ($\alpha$) and <strong>P-Value</strong>: A result is considered <strong>significant</strong> if the evidence against $H_0$ is strong. The <strong>p-value</strong> measures this evidence. It indicates the probability of observing data as extreme as ours if $H_0$ were true. A low p-value (typically &lt; 0.05) suggests strong evidence against $H_0$.</p>
</div></blockquote>
<p>Now, let’s apply our hypothesis testing framework by simulating a dataset and examining the results.</p>
<section id="a-simulate-a-dataset">
<h4><span class="section-number">4.3.1.1. </span>a) Simulate a Dataset<a class="headerlink" href="#a-simulate-a-dataset" title="Link to this heading">#</a></h4>
<p>We’ll start by generating a dataset from a normal distribution, specifically $X \sim N(5, 1.5)$.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">Math</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">1.5</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([5.74507123, 4.79260355, 5.97153281, 7.28454478, 4.64876994,
       4.64879456, 7.36881922, 6.15115209, 4.29578842, 5.81384007])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="n">sample_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="n">sample_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-our-hypothesis">
<h4><span class="section-number">4.3.1.2. </span>Define our hypothesis<a class="headerlink" href="#define-our-hypothesis" title="Link to this heading">#</a></h4>
<p>Our null hypothesis ($H_0$) states that the population mean is equal to 8. The alternative hypothesis ($H_1$) suggests that the mean is different from this value.</p>
<p>$$H_0: \mathbb{E}[X] =8, \quad H_1: \mathbb{E}[X] \neq 8.$$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu_0</span><span class="o">=</span><span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-a-significance-level-alpha">
<h4><span class="section-number">4.3.1.3. </span>Set a significance level $\alpha$<a class="headerlink" href="#set-a-significance-level-alpha" title="Link to this heading">#</a></h4>
<p>The significance level $\alpha$ is the threshold we set for deciding how much evidence we need to reject $H_0$. It represents the risk we are willing to accept for falsely rejecting the $H_0$ (Type I error). Common choices for 𝛼 are
0.05 or
0.01. This means we are willing to accept a 5% or 1% chance of making an error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Significance level</span>
<span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="d-compute-t-n">
<h4><span class="section-number">4.3.1.4. </span>d) Compute $T_n$<a class="headerlink" href="#d-compute-t-n" title="Link to this heading">#</a></h4>
<p>To quantitatively assess whether our sample provides enough evidence to reject $H_0$, we use the t-test statistic:</p>
<p>$$T_n = \frac{\sqrt{n}}{\hat{\sigma}_n} \left( |\overline{X_n} - \mu_0| \right).$$</p>
<p>$T_n$ measures how far our sample mean ($\overline{X_n}$) is from the hypothesized mean ($\mu_0$). The larger the value of $T_n$, the more evidence we have against the null hypothesis ($H_0$).</p>
<blockquote>
<div><p>Recall that, as the sample size  $n$ increases, the distribution of the sample mean $\bar{X_n}$ approaches normality due to the Central Limit Theorem (CLT):</p>
</div></blockquote>
<p>$$
\bar{X_n} \sim N(\mu, \frac{\sigma}{\sqrt{n}})
$$</p>
<p>This implies,</p>
<p>$$
T_n \sim N(0, 1).
$$</p>
<p>This property enables the use of normal distribution properties to derive critical values, calculate p-values, and make informed decisions based on statistical evidence.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_test_statistic</span><span class="p">(</span><span class="n">sample_mean</span><span class="p">,</span> <span class="n">sample_std</span><span class="p">,</span> <span class="n">mu_0</span><span class="p">):</span>
    <span class="n">T_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sample_mean</span> <span class="o">-</span> <span class="n">mu_0</span><span class="p">)</span> <span class="o">/</span> <span class="n">sample_std</span>
    <span class="k">return</span> <span class="n">T_n</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T_n</span> <span class="o">=</span> <span class="n">compute_test_statistic</span><span class="p">(</span><span class="n">sample_mean</span><span class="p">,</span> <span class="n">sample_std</span><span class="p">,</span> <span class="n">mu_0</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Math</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T_n: </span><span class="si">{</span><span class="n">T_n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle T_n: 63.995650085846194\]</div>
</div>
</div>
</section>
<section id="define-the-critical-value-c">
<h4><span class="section-number">4.3.1.5. </span>Define the critical value $c$<a class="headerlink" href="#define-the-critical-value-c" title="Link to this heading">#</a></h4>
<p>To determine the critical value $c$, we want to find the value such that:</p>
<p>$$
2\big(1 - \Phi(c)\big) = \alpha,
$$</p>
<p>where $\Phi$ is the CDF of the standard normal distribution. The factor of 2 accounts for the two-sided nature of our test. For more details on how this was derived, please refer to lecture notes.</p>
<ul>
<li><p>Rearranging this equation helps us find $\Phi(c) $:</p>
<p>$$
\Phi(c) = 1 - \frac{\alpha}{2}
$$</p>
</li>
</ul>
<p>This gives us the critical value that corresponds to our chosen $\alpha$.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">critical_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Math</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">text</span><span class="se">{{</span><span class="s2">For </span><span class="se">}}</span><span class="s2"> </span><span class="se">\\</span><span class="s2">alpha = </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, </span><span class="se">\\</span><span class="s2">text</span><span class="se">{{</span><span class="s2">the critical value</span><span class="se">}}</span><span class="s2"> \, c \,</span><span class="se">\\</span><span class="s2">text</span><span class="se">{{</span><span class="s2">is</span><span class="se">}}</span><span class="s2"> \, </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">critical_value</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:2: SyntaxWarning: invalid escape sequence &#39;\,&#39;
&lt;&gt;:2: SyntaxWarning: invalid escape sequence &#39;\,&#39;
&lt;&gt;:2: SyntaxWarning: invalid escape sequence &#39;\,&#39;
&lt;&gt;:2: SyntaxWarning: invalid escape sequence &#39;\,&#39;
/tmp/ipykernel_170071/1471066836.py:2: SyntaxWarning: invalid escape sequence &#39;\,&#39;
  display(Math(f&quot;\\text{{For }} \\alpha = {alpha}, \\text{{the critical value}} \, c \,\\text{{is}} \, {round(critical_value, 2)}&quot;))
/tmp/ipykernel_170071/1471066836.py:2: SyntaxWarning: invalid escape sequence &#39;\,&#39;
  display(Math(f&quot;\\text{{For }} \\alpha = {alpha}, \\text{{the critical value}} \, c \,\\text{{is}} \, {round(critical_value, 2)}&quot;))
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \text{For } \alpha = 0.05, \text{the critical value} \, c \,\text{is} \, 1.96\]</div>
</div>
</div>
<blockquote>
<div><p>Understanding the Type I Error Rate: By setting a critical value $c$, we control the Type I error rate. I.e., if $H_0$ is true, the probability that our test statistic falls beyond $c$ (rejection region) is equal to $\alpha$:</p>
</div></blockquote>
<p>$$
P(T_n &gt; c) = \alpha.
$$</p>
</section>
<section id="p-n">
<h4><span class="section-number">4.3.1.6. </span>$p_n$<a class="headerlink" href="#p-n" title="Link to this heading">#</a></h4>
<p>To measure the strength of evidence against the null hypothesis ($H_0$), we estimate the p-value $\hat{p_n}$:</p>
<p>$$
\hat{p_n} = 2(1 - \Phi(T_n)).
$$</p>
<p>This p-value tells us the smallest significance level $\alpha$ at which we would reject $H_0$. If $T_n$ is large, $\hat{p_n}$ will be small, indicating strong evidence against $H_0$. A smaller p-value means the observed data is very unlikely under the null hypothesis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_p_value</span><span class="p">(</span><span class="n">T_n</span><span class="p">):</span>
    <span class="n">p_value</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">T_n</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">p_value</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_value</span> <span class="o">=</span> <span class="n">compute_p_value</span><span class="p">(</span><span class="n">T_n</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Math</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">hat p_n = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \hat p_n = 0.0\]</div>
</div>
</div>
<p>A <strong>p-value of 0.0</strong> (or very close to 0) suggests <strong>strong evidence against the null hypothesis</strong>. In other words, the difference between the sample mean and the population mean is statistically significant.</p>
<ul class="simple">
<li><p>Typically, if the p-value is below a chosen significance level (e.g., 0.05), we reject the null hypothesis.</p></li>
</ul>
<p>Alternatively, we could use a predefined function within the SciPy library to perform a one-sample t-test.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">mu_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TtestResult(statistic=np.float64(-63.9636442573448), pvalue=np.float64(0.0), df=np.int64(999))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(-1.962341461133449)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(1.9623414611334487)
</pre></div>
</div>
</div>
</div>
</section>
<section id="confidence-sets">
<h4><span class="section-number">4.3.1.7. </span>Confidence Sets<a class="headerlink" href="#confidence-sets" title="Link to this heading">#</a></h4>
<p>For a two-sided test, the confidence interval is given by:
$$
C_n = \left[\overline{X_n} \pm \frac{\hat{\sigma}_n}{\sqrt{n}} \Phi^{-1}\left(1 - \frac{\alpha}{2}\right)\right]
$$</p>
<p>where $\frac{\hat{\sigma}_n}{\sqrt{n}} \Phi^{-1}\left(1 - \frac{\alpha}{2}\right)$ represents the margin of error around the sample mean.</p>
<p>This interval will give us a range of values that, with a certain level of confidence (typically 95%), is likely to contain the true population mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_confidence_interval</span><span class="p">(</span><span class="n">sample_mean</span><span class="p">,</span> <span class="n">sample_std</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
    <span class="n">z_critical</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">margin_of_error</span> <span class="o">=</span> <span class="n">z_critical</span> <span class="o">*</span> <span class="p">(</span><span class="n">sample_std</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">confidence_interval</span> <span class="o">=</span> <span class="p">(</span><span class="n">sample_mean</span> <span class="o">-</span> <span class="n">margin_of_error</span><span class="p">,</span> <span class="n">sample_mean</span> <span class="o">+</span> <span class="n">margin_of_error</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">confidence_interval</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">confidence_interval</span> <span class="o">=</span> <span class="n">compute_confidence_interval</span><span class="p">(</span><span class="n">sample_mean</span><span class="p">,</span> <span class="n">sample_std</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% Confidence Interval: </span><span class="si">{</span><span class="n">confidence_interval</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95% Confidence Interval: (np.float64(4.9380066375012746), np.float64(5.119989529965702))
</pre></div>
</div>
</div>
</div>
<p>Finally, we can visualize the results using a plot that includes the simulated sample, the sample mean, the hypothesized mean, and the confidence interval.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sample&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Sample Mean&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">confidence_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Lower Bound&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">confidence_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Upper Bound&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">mu_0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Hypothesized Mean ($\mu = 8$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;95% Confidence Interval for Sample Mean&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Value&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Density&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:7: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:7: SyntaxWarning: invalid escape sequence &#39;\m&#39;
/tmp/ipykernel_170071/3690128830.py:7: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.axvline(mu_0, color=&#39;blue&#39;, linestyle=&#39;-.&#39;, linewidth=1, label=&quot;Hypothesized Mean ($\mu = 8$)&quot;)
</pre></div>
</div>
<img alt="../_images/b53fbe33c01d2b66d24c1d34599ed7b08b18563defbdde9df9fb11ff14d806b8.png" src="../_images/b53fbe33c01d2b66d24c1d34599ed7b08b18563defbdde9df9fb11ff14d806b8.png" />
</div>
</div>
</section>
</section>
</section>
<section id="statistics-final-recap">
<h2><span class="section-number">4.4. </span>Statistics (final recap)<a class="headerlink" href="#statistics-final-recap" title="Link to this heading">#</a></h2>
<p>Consider the following example: estimating Instagram followers.</p>
<ol class="arabic simple">
<li><p><strong>Population Parameter ($\mu_x$)</strong>: The unknown true average number of Instagram followers for all NYU students.</p></li>
<li><p><strong>Population</strong>: The entire group of NYU students, which is too large to fully survey in most cases.</p></li>
<li><p><strong>Sample</strong>: A smaller group of students selected from the population to gather data on their Instagram followers.</p></li>
<li><p><strong>Estimator</strong>: The sample average, denoted by $ \overline{X_n} $, which serves as an estimate of the population parameter $ \mu_x $.</p></li>
<li><p><strong>Estimate</strong>: The specific value of the sample average, such as $ \overline{x_A} $ for Student A’s sample or $ \overline{x_B} $ for Student B’s sample.</p></li>
<li><p><strong>Random Variable</strong>: The estimator $ \overline{X_n} $ is a random variable because its value depends on the sample chosen, and different samples will yield different estimates.</p></li>
</ol>
<blockquote>
<div><p>Things to Consider:</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>How should we choose the sample?</strong></p></li>
<li><p><strong>What would happen if we only interviewed our NYU Instagram followers as our sample?</strong></p></li>
<li><p><strong>How many students do we need to survey for a reliable sample?</strong></p></li>
</ul>
<p>Now, imagine each of us takes a sample and calculates the average number of Instagram followers. For example, Student A selects a sample and computes an average, denoted $ \overline{x_A} $, which we refer to as an <strong>estimate</strong>. However, if Student B had taken a different sample, their estimate $ \overline{x_B} $ would likely be different, because the estimator $ \overline{X_n} $ is a <strong>random variable</strong>, as its value depends on the specific sample chosen.</p>
<blockquote>
<div><p>What if we don’t require everyone to use the average as an estimator?</p>
</div></blockquote>
<p>Each of us could choose a different strategy (estimator), and we would need to compare these estimators using concepts like <strong>unbiasedness</strong> and <strong>efficiency</strong>. Let’s suppose that our best estimator from all the available options in the classroom is given by</p>
<p>$$
\bar{x}<em>n = \frac{1}{n} \sum</em>{i=1}^{n} x_i = 250
$$</p>
<p>$$
\sigma^2_{\bar{x}} = \frac{\sigma^2_x}{n} = 2500
$$</p>
<p>Now, imagine a student claims to be quite popular with 100 Instagram followers. However, our sample estimate indicates that the average number of followers is 250. The student might chuckle and argue that the true population average $\mu_x$ is actually 150.</p>
<blockquote>
<div><p>Can we definitively prove this student wrong?</p>
</div></blockquote>
<p>No, but using statistics, we can estimate how <strong>likely</strong> it is to get an average of 250 if $\mu_x$ is 150. This is where <strong>hypothesis testing</strong> comes into play.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters</span>
<span class="n">sample_mean</span> <span class="o">=</span> <span class="mi">250</span>
<span class="n">std_dev</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">sample_size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">mu_x</span> <span class="o">=</span> <span class="mi">150</span>

<span class="c1"># Simulating sample data</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">sample_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">std_dev</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">)</span>

<span class="c1"># Plotting</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sample&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">sample_mean</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observed Sample Mean&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">mu_x</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Hypothesized Population Mean ($\mu_x = 250$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sample Distribution of Instagram Followers&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Followers&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Density&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:16: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:16: SyntaxWarning: invalid escape sequence &#39;\m&#39;
/tmp/ipykernel_170071/3308747972.py:16: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  plt.axvline(mu_x, color=&#39;blue&#39;, linestyle=&#39;-.&#39;, linewidth=1, label=&quot;Hypothesized Population Mean ($\mu_x = 250$)&quot;)
</pre></div>
</div>
<img alt="../_images/7b66297a58534dbe3eafda75466eeb8532cf561f955a618db3f11211af1d7458.png" src="../_images/7b66297a58534dbe3eafda75466eeb8532cf561f955a618db3f11211af1d7458.png" />
</div>
</div>
<p><strong>Hypotheses</strong>:</p>
<ul class="simple">
<li><p>$H_0$: The true mean number of followers is 150.</p></li>
<li><p>$H_1$: The true mean number of followers is not 150.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T_n</span> <span class="o">=</span> <span class="n">compute_test_statistic</span><span class="p">(</span><span class="n">sample_mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="p">,</span> <span class="n">mu_x</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Math</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T_n: </span><span class="si">{</span><span class="n">T_n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle T_n: 63.24555320336758\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_value</span> <span class="o">=</span> <span class="n">compute_p_value</span><span class="p">(</span><span class="n">T_n</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Math</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">hat p_n = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \hat p_n = 0.0\]</div>
</div>
</div>
<p>Given these results, we can:</p>
<ul class="simple">
<li><p><strong>Reject the Null Hypothesis</strong>: The data provides very strong evidence against the null hypothesis ($H_0: \mu = 150$). This means that it is highly unlikely that the true population mean is (150). There is strong evidence to suggest that the true population mean is significantly higher than (150).</p></li>
</ul>
</section>
<section id="experiments">
<h2><span class="section-number">4.5. </span>Experiments<a class="headerlink" href="#experiments" title="Link to this heading">#</a></h2>
<p>Let’s say we want to understand the effect of a job training program (S) on wages (Y) (example seen last lecture). To estimate this causal effect, the government launches a survey asking households if they’ve participated in job training programs through public libraries or other resources.</p>
<blockquote>
<div><p>Can we truly estimate causal effects from this data? How could unmeasured factors ($U$), influence our estimates? Consider how these factors can complicate our understanding of the true impact of job training on wages.</p>
</div></blockquote>
<p>Let’s visualize this in an observational setting using a Directed Acyclic Graph (DAG), where our outcome of interest is wage ((Y)).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">edges</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;Job Training&#39;</span><span class="p">,</span> <span class="s1">&#39;Wage&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Job Training&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Wage&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Race&#39;</span><span class="p">,</span> <span class="s1">&#39;Job Training&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Race&#39;</span><span class="p">,</span> <span class="s1">&#39;Wage&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Prior Income&#39;</span><span class="p">,</span> <span class="s1">&#39;Job Training&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Prior Income&#39;</span><span class="p">,</span> <span class="s1">&#39;Wage&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>

<span class="n">pos</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Job Training&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="s1">&#39;Wage&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;Race&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;Prior Income&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">node_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;white&#39;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()]</span>
<span class="n">outline_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;green&#39;</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Wage&#39;</span><span class="p">,</span> <span class="s1">&#39;Job Training&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;lightgray&#39;</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arrows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="n">node_colors</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">(),</span> <span class="n">outline_colors</span><span class="p">):</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="n">node_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">3000</span><span class="p">)</span>

<span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">edge</span> <span class="o">==</span> <span class="p">(</span><span class="s1">&#39;Job Training&#39;</span><span class="p">,</span> <span class="s1">&#39;Wage&#39;</span><span class="p">):</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">edgelist</span><span class="o">=</span><span class="p">[</span><span class="n">edge</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">edgelist</span><span class="o">=</span><span class="p">[</span><span class="n">edge</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Effect of Job Training Program on Wage? (Observational Data)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;whitesmoke&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># Turn off the axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Turn off grid</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8fd9c6e9d75011085a3d835f2f03fd6be7153376f693fc7b9a0cc048c70ad3e8.png" src="../_images/8fd9c6e9d75011085a3d835f2f03fd6be7153376f693fc7b9a0cc048c70ad3e8.png" />
</div>
</div>
<p>Here:</p>
<ul class="simple">
<li><p>$ U $ represents confounding factors such as education, experience, and socioeconomic status. These factors influence both the likelihood of participating in the job training program ($ S $) and the wages or income ($ Y $).</p></li>
<li><p>The arrow from $ U $ to $ S $ indicates that individuals with higher education or more experience are more likely to enroll in job training programs.</p></li>
<li><p>$ U $ affects $ Y $ because education and experience are key determinants of wages.</p></li>
<li><p>Participation in the job training program ($ S $) directly influences wages ($ Y $), as the training may enhance skills and lead to higher income.</p></li>
</ul>
<p><em>Confounding bias</em> occurs because the relationship from $ S $ to $ Y $ is affected by $ U $. This makes it difficult to separate the true impact of the training ($ S $) from the influence of the confounding factors ($ U $).</p>
<p>As a result, we might observe that the average wage for participants in the training is lower than the average wage for the broader population that could benefit from such training:</p>
<p>$$ \mathbb{E}[Y(S = 1, U)|S = 1] &lt; \mathbb{E}[Y(S = 1, U)], $$</p>
<p>causing the job training program to appear less effective than it truly is.</p>
<p>To address this issue, we use randomized controlled trials (RCTs) to isolate the effect of the training. By randomizing treatment assignment, and assuming:</p>
<ul class="simple">
<li><p>Perfect compliance, and</p></li>
<li><p>SUTVA</p></li>
</ul>
<p>we ensure $ S \perp U $.</p>
<p><strong>Note, while $ S $ still directly affects $ Y $, and $ U $ continues to influence $ Y $ (since factors like education and experience impact wages), $ U $ no longer has any effect on $ S $.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">edges</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;Job Training&#39;</span><span class="p">,</span> <span class="s1">&#39;Wage&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Wage&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Race&#39;</span><span class="p">,</span> <span class="s1">&#39;Wage&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Prior Income&#39;</span><span class="p">,</span> <span class="s1">&#39;Wage&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>

<span class="n">pos</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Job Training&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="s1">&#39;Wage&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;Race&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;Prior Income&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">node_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;white&#39;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()]</span>
<span class="n">outline_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;green&#39;</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Wage&#39;</span><span class="p">,</span> <span class="s1">&#39;Job Training&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;lightgray&#39;</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arrows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="n">node_colors</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">(),</span> <span class="n">outline_colors</span><span class="p">):</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="n">node_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">3000</span><span class="p">)</span>

<span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">edge</span> <span class="o">==</span> <span class="p">(</span><span class="s1">&#39;Job Training&#39;</span><span class="p">,</span> <span class="s1">&#39;Wage&#39;</span><span class="p">):</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">edgelist</span><span class="o">=</span><span class="p">[</span><span class="n">edge</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">edgelist</span><span class="o">=</span><span class="p">[</span><span class="n">edge</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Effect of Job Training Program on Wage? (RCT)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;whitesmoke&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># Turn off the axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Turn off grid</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7c961f401105950cafaf3b197125d2e2065ceaef2bf083c50ba6a64295f5a636.png" src="../_images/7c961f401105950cafaf3b197125d2e2065ceaef2bf083c50ba6a64295f5a636.png" />
</div>
</div>
<p>After randomization, assuming perfect compliance and SUTVA:</p>
<ul>
<li><p>The average outcome in the treatment group is equal to that of the overall population receiving treatment:</p>
<p>$$
E[Y(S = 1, U) | S = 1] = E[Y(S = 1, U)].
$$</p>
</li>
<li><p>The average outcome in the control group matches that of the overall population without treatment:</p>
<p>$$
E[Y(S = 0, U) | S = 0] = E[Y(S = 0, U)].
$$</p>
</li>
</ul>
<p>This implies that, despite the fundamental problem of causal inference, we can estimate the Average Treatment Effect (ATE) since there are no systematic differences between groups. Thus, we can express the ATE as:</p>
<p>$$
ATE = E[Y(S = 1, U) | S = 1] - E[Y(S = 0, U) | S = 0].
$$</p>
</section>
<section id="path-forward">
<h2><span class="section-number">4.6. </span>Path Forward<a class="headerlink" href="#path-forward" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Next time, we will:</p>
<ul>
<li><p>Focus on the final step in answering causal questions: estimation.</p></li>
<li><p>Explore what happens when we relax the assumptions of:</p>
<ul>
<li><p>Perfect compliance</p></li>
<li><p>SUTVA</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr class="docutils" />
<p><strong>References:</strong></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./sections"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="3_Probability_Statistics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Probability, All Causes Model and Statistics</p>
      </div>
    </a>
    <a class="right-next"
       href="5_Experiments.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Experiments (Cont.)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-from-last-class">4.1. Recap from last class</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#goals-for-today">4.2. Goals for today</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-testing">4.3. Hypothesis Testing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-concepts">4.3.1. Key Concepts</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simulate-a-dataset">4.3.1.1. a) Simulate a Dataset</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-our-hypothesis">4.3.1.2. Define our hypothesis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-a-significance-level-alpha">4.3.1.3. Set a significance level $\alpha$</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#d-compute-t-n">4.3.1.4. d) Compute $T_n$</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-critical-value-c">4.3.1.5. Define the critical value $c$</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#p-n">4.3.1.6. $p_n$</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-sets">4.3.1.7. Confidence Sets</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistics-final-recap">4.4. Statistics (final recap)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#experiments">4.5. Experiments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#path-forward">4.6. Path Forward</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Daniela Pinto Veizaga, Xiang Pan, and Xiang Gao
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>